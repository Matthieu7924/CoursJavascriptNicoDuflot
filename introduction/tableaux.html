<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formation Javascript Ecmascript</title>
    <link rel="stylesheet" href="../css/bootstrap.css" />
    <script src="../js/bootstrap.bundle.js"></script>
    <script>
        /* Avant es6 */
        /*
        var tableau = new Array('valeur', 1, 12.3, true );
        */

        /* depuis es6 */
        let cars = ['Peugeot', 'Citroën', 'Ford', 'Renault'];
        console.log(cars);
        console.log(cars[1]);
        console.log(`Le tableau cars : ${cars} contient ${cars.length} élément(s)`);

        /* les tableaux sont des objets itérables */
        /* on utilise alors des boucles pour les parcourir */

        /* La boucle Pour */

        console.log('-------------------- boucle for -------------------');
        for(let i = 0; i < cars.length; i++){
            console.log(`la valeur à l'index ${i} est ${cars[i]}`);
        }

        console.log('-------------------- boucle for in -------------------');
        for(let index in cars){
            console.log(`la valeur à l'index ${index} est ${cars[index]}`);
        }

        /* le for in permet aussi d'itérer sur les attibuts et méthodes d'un objet */
        let obj = {
            nom: 'Duflot',
            prenom: 'Nicolas',
            age: 42,
            presentation: function(){
                return `bonjour, je m'appelle ${this.nom} ${this.prenom} et j'ai ${this.age} ans.`;
            }
        }

        console.log(obj.presentation());

        for(let key in obj){
            console.log(`${key} contient ${obj[key]} du type ${typeof obj[key]}`);
        }

        /* depuis es6 for of */
        console.log('-------------------- boucle for of -------------------');
        for(let value of cars){
            console.log(`la valeur actuelle dans cars est ${value}`);
        }

        /* tant que et faire tant que */
        console.log('-------------------- boucle while -------------------');
        let cpt = 0;
        while(cpt < cars.length){
            console.log(cars[cpt]);
            cpt++;
        }

        console.log('-------------------- boucle do while -------------------');
        cpt = 0;
        do{
            console.log(cars[cpt]);
            cpt++;
        }while(cpt < cars.length)

        console.log('-------------------- sortir ptématurément d\'une boucle -------------------');
        cpt = 0;
        do{
            if(cars[cpt] === 'Ford'){
                console.log(cars[cpt]);
                break;
            }
            cpt++;
        }while(cpt < cars.length)

        /* la méthode forEach() */
        console.log('-------------------- forEach() -------------------');
        cars.forEach(function(value, index, tab){
            console.log(`la valeur ${value} se trouve à l'index ${index} du tableau : ${tab}`);
        });

        let tabNumber = [1, 2, 3, 4, 5];

        console.log(tabNumber);

        console.log('-------------------- forEach() -------------------');
        tabNumber.forEach(function(value, index, tab){
            tab[index] = value*0.3;
        });

        console.log(tabNumber);

        /**
         * es6 .entries()
         * modèle objet,
         * renvoi chaque élément du tableau sous forme d'un tableau contenant l'index et la valeur
        */

        console.log('------------- méthode entries() --------------');
        for(let entry of cars.entries()){
            console.log(entry);
            console.log(entry[0]);
            console.log(entry[1]);
        }

        /* la méthode .map() est l'équivalent d'un forEach() mais est propres aux tableaux */
        console.log('-------------------- .map() -------------------');
        cars.map(function(value, index, tab){
            console.log(`la valeur ${value} se trouve à l'index ${index} du tableau : ${tab}`);
        });


        /* la méthode .keys() */
        console.log('-------------------- .keys() -------------------');
        for(let key of cars.keys()){
            console.log(key, cars[key]);
        }

        /* ajouter des éléments dans un tableau ? */

        cars[cars.length] = 'Hyundai'; /* ça marche mais non merci */

        cars.push('Seat');
        cars.push('Fiat', 'Toyota');

        /*
        cars[10] = 'Toto';

        console.log(cars);

        console.log('-------------------- forEach() -------------------');
        cars.forEach(function(value, index, tab){
            console.log(`la valeur ${value} se trouve à l'index ${index} du tableau : ${tab}`);
        });
        */

        /* supprimer (mais pas vraiment) des valeurs d'un tableau */
        /**
         * .pop()
         * .shift()
         * splice()
         * 
        */

        /* .pop() : extrait la dernière valeur d'un tableau */
        let extractLast = cars.pop();
        console.log(cars);
        console.log(extractLast);

        /** 
         * .shift() : récupère la première valeur du tableau, décale les valeurs restante vers "l'avant" du tableau puis "détruit" la dernière "case" 
         * */

        let extractFirst = cars.shift();
        console.log(cars);
        console.log(extractFirst);

        /* .splice() 1 : extraire des valeurs du tableau sous forme d'un tableau */
        let tabRemoved = cars.splice(cars.indexOf('Ford'), 2);
        console.log(cars);
        console.log(tabRemoved);

        /* .splice() 2 : remplacer des valeurs du tableau par d'autres valeur et renvoyer les valeur remplacées sous forme d'un tableau */
        let tabReplaced = cars.splice(cars.indexOf('Citroën'), 2, 'Alpine', 'Mazda', 'Kya');
        console.log(cars);
        console.log(tabReplaced);

        /* .splice() 3 : inserrer des valeurs dans le tableau */
        cars.splice(cars.indexOf('Mazda'), 0, extractFirst, extractLast, tabRemoved[0], tabRemoved[1], tabReplaced[0], tabReplaced[1]);
        console.log(cars);

        /* comment copier un tableau */

        /*
        let cloneCars = cars;
        console.log(cloneCars);

        cloneCars.pop();
        console.log(cloneCars);
        console.log(cars);
        */ 

        /* slice() */
        let cloneCars = cars.slice();
        console.log(cloneCars);

        cloneCars.pop();
        console.log(cloneCars);
        console.log(cars);

        /* .sort() */
        cloneCars.sort();
        console.log(cloneCars);

        /* 
        .reverse() 
        reverse ne tri par, mais inverse les valeur dans les index du tableau :
        la première valeur devient la dernière, la dernière la première, etc.
        */
        cloneCars.reverse();
        console.log(cloneCars);

        let test = 'olalala';
        tabTest = test.split('');
        console.table(tabTest);
        test = tabTest.sort().reverse().join('');
        console.log(test);

        carsTest = [ ['Fiat', 1956], ['Kya', 1995], ['Kya', 1990], ['Ford', 1950] ];
        console.table(carsTest);
        carsTest.sort();
        console.table(carsTest);

        /* les tableaux à 2 voir 3 dimension n'existe pas vraiment en JS */
        let tab2d = [ ['a', 'b', 'c'], [12,13,12,15,14], [10, 23, 56, 4] ];
        console.table(tab2d);
        /* afficher  */
        console.log(tab2d[1][1]);
        /* 
        dans des langages compilé du type c++ ou java, les tableau à deux dimension sont réels et typés 
        int tab[10] //un tableau en c++
        int tab2d[5,5] // un tableau à 2 dimension d'entier, 5 lignes, 5 colonnes
        */

        /* créer une matrice devient un peu galère */
        let matrice = [
            [1,  2,  3,  4,  5 ],
            [12, 14, 75, 56, 42]
        ];

        /* pour parcourir la matrice */
        console.log('--- parcourir la matrice "2d" ---------');
        for(let value of matrice){
            let line = '';
            for(subValue of value){
                line += subValue + ' ';
                //console.log(subValue);
            }
            console.log(line);
        }

        console.log('--- parcourir la matrice "2d" ---------');
        matrice.map(function(value, index){
            value.map(function(subValue, subIndex){
                console.log(`X : ${index}, Y : ${subIndex} => ${subValue}`);
            });
        });

        /* retrouver une ou des valeurs dans un tableau */
        /* .find() => retourne la première occurence dans un tableau */

        console.log('--------- .find() ------------');
        let arrayNum = [5, 8, 12, 130, 5, 3, 44];
        let found = arrayNum.find(function(element){
            return 20 < element;
            /*
            if(20 < element){
                return element;
            }
            */
        });

        console.log(found);

        /* pour récupérertous les éléments correpsondant à une condition .filter() */
        let foundAll = arrayNum.filter(function(element){
            return 20 < element;
        });

        console.table(foundAll);
        
        /* opérateur arrow */
        /*
        function(){
            //code
        }
        devient 
        ()=>{
            //code
        }

        function(variable){
            //code
        }
        devient 
        (variable)=>{
            //code
        }

        function(variable){
            return variable*2;
        }
        devient 
        (variable)=>variable*2;

        function(variable){
            return variable;
        }
        devient 
        (variable)=>variable;
        
        */
        let foundAll2 = arrayNum.filter((element)=> 20 < element);

        /*
        les fonction de rappel (callback functions) ou fonctions 
        anonymes génèrent des conséquences quand elles sont trop imbriqués 
        c'est à surveiller lors de l'utilisation du this d'un objet 
        dans les méthodes de l'objet
        */

        console.log('---------------- les conséquences --------------');
        let monObjet = {
            numbers: [1, 2, 56, 13, 123],
            affTab: function(){
                console.log(this);
                let _this = this;
                this.numbers.forEach(function(value){
                    console.log(this);
                    console.log(_this);
                });
            },
            affTab2: function(){
                console.log(this);
                let _this = this;
                this.numbers.forEach((value)=>{
                    console.log(this);
                });
            }
        };

        monObjet.affTab();
        monObjet.affTab2();

        /* 
        créer un tableau avec des fruits et des légumes, avec deux fruits ou légumes en doublons 
        modifier le tableau pour que : 
            - les fruits et légumes soient triés par ordre alphabétiques
            - que les doublons soient supprimés du tableau
            - qu'on affiche un tableau des doublons et le nombre d'occurence de chaque doublons
        */

        let fruitEtLegumes = [
            'fraise',
            'bananes',
            'mangue',
            'choux',
            'mangue',
            'courgette',
            'fraise',
            'brocoli', 
            'haricot',
            'mangue'
        ];
        
        console.log(fruitEtLegumes);
        fruitEtLegumes.sort();
        let tabTemp = [];
        let tabDoublons = [];

        /* 
        le tableau tabTemp est un fait un tableau dont les clefs sont les nom des fruits plutôt qu'un indice 
        si la "case" avec une clef n'existe pas, on la crée avec la valeur 1 (le fruit existe une fois)
        si la "case" avec une clef existe pas, on augmente de 1 sa valeur

        */
        fruitEtLegumes.forEach(function(value, index){
            if(tabTemp[value] === undefined ){
                //console.log(tabTemp[value]);
                tabTemp[value] = 1;
            }else{
                //console.log(tabTemp[value]);
                tabTemp[value] = tabTemp[value]+1;
            }
        });

        /*
        on vide le tableau de départ
        */
        fruitEtLegumes.splice(0, fruitEtLegumes.length);
        /* 
        pour chaque fruit (key du tableau) de tabTemp
        */
        for(key in tabTemp){
            /* la "clef" fruit devient une valeur du tableau des fruit */
            fruitEtLegumes.push(key);
            /* si la valeur associée à la clef fruit est supérieure à 1, on alimente le tableau des doublons */
            if(tabTemp[key] > 1){
                tabDoublons.push([key, tabTemp[key]]);
            }
        }

        console.log(tabTemp);
        console.log(tabDoublons);
        console.log(fruitEtLegumes);

        /* c'est mieux d'utiliser la classe Map avec la méthode set */
        let legumeDoublons = new Map();
        legumeDoublons.set('fraise', 1);
        legumeDoublons.set('brocoli', 1);
        
        console.log(legumeDoublons.get('fraise'));

    </script>
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="../">Home</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Introduction
                </a>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="../introduction/index.html">Premiers Scripts</a></li>
                  <li><a class="dropdown-item" href="../introduction/tableaux.html">Les tableaux</a></li>
                  <li><a class="dropdown-item" href="../introduction/fonctions.html">Les fonctions</a></li>
                  <li><a class="dropdown-item" href="../introduction/destructuration.html">La destructuration</a></li>
                  <li><a class="dropdown-item" href="../introduction/storage.html">Storage</a></li>
                </ul>
              </li>
            </ul>
            <form class="d-flex" role="search">
              <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success" type="submit">Search</button>
            </form>
          </div>
        </div>
      </nav>
      <main class="container">
        <section class="row">
            <article class="col">
                <header>
                    <h2>Les tableaux</h2>
                </header>
                <main>
                    <p>
                        Tous est dans la console & le code
                    </p>
                    <p>
                        <a href="./exotableaux.html">Un exercice sur les tableaux</a>
                    </p>
                </main>
            </article>
        </section>
      </main>
</body>
</html>